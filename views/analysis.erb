<html>
	<head>
		<meta http-equiv=Content-Type content="text/html; charset=utf-8">
		<meta name="viewport" 
        content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=0">
		<style type="text/css">

		</style>
		<title>调查结果</title>
		<!-- 新 Bootstrap 核心 CSS 文件 -->
		<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
		<!-- 可选的Bootstrap主题文件（一般不用引入） -->
		<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
		<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
		<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
		<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
		<script src="//cdn.hcharts.cn/highcharts/highcharts.js"></script>
	</head>
	<body>
		<div id="chart-field"></div>
		<script>
			$.getJSON("/vote_analysis",function(data){
				data.forEach(function(q,i){
					var ele=document.createElement('div');
					$("#chart-field").append(ele);
					$(ele).attr("width","80%");
					$(ele).attr("height","15em");
					$(ele).attr("id","chart_"+i);
					$("#chart_"+i).highcharts({
						// Highcharts 配置
						chart:{
							style:{
								fontFamily:"",
								fontSize:'12px',
								fontWeight:'bold',
								color:'#006cee'
							},
							renderTo:"chart_"+i, // 注意这里一定是 ID 选择器
						},
						title:{text: q.ques},
						tooltip: {
							pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
						},
						plotOptions: {
							pie: {
								allowPointSelect: true,
								cursor: 'pointer',
								dataLabels: {
									enabled: true,
									color: '#000000',
									connectorColor: '#000000',
									format: '<b>{point.name}</b>: {point.percentage:.1f} %'
								}
							}
						},
						series: [{
								type: "pie",
								name: q.ques,
								data: q.options.map(function(o){
									return [o.option,o.count];
								}),
						}],
					});
				});
			});
		</script>
	</body>
</html>
